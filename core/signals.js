!function(i){var t={VERSION:"0.6.3"};function n(i,t,n,e,s){this._listener=t,this._isOnce=n,this.context=e,this._signal=i,this._priority=s||0}function e(i,t){if("function"!=typeof i)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}n.prototype={active:!0,params:null,execute:function(i){var t,n;return this.active&&this._listener&&(n=this.params?this.params.concat(i):i,t=this._listener.apply(this.context,n),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener):null},isBound:function(){return!!this._signal&&!!this._listener},getListener:function(){return this._listener},_destroy:function(){delete this._signal,delete this._listener,delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce: "+this._isOnce+", isBound: "+this.isBound()+", active: "+this.active+"]"}},t.Signal=function(){this._bindings=[]},t.Signal.prototype={_shouldPropagate:!0,active:!0,_registerListener:function(i,t,e,s){var r,h=this._indexOfListener(i);if(-1!==h){if((r=this._bindings[h]).isOnce()!==t)throw new Error("You cannot add"+(t?"":"Once")+"() then add"+(t?"Once":"")+"() the same listener without removing the relationship first.")}else r=new n(this,i,t,e,s),this._addBinding(r);return r},_addBinding:function(i){var t=this._bindings.length;do{--t}while(this._bindings[t]&&i._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,i)},_indexOfListener:function(i){for(var t=this._bindings.length;t--;)if(this._bindings[t]._listener===i)return t;return-1},add:function(i,t,n){return e(i,"add"),this._registerListener(i,!1,t,n)},addOnce:function(i,t,n){return e(i,"addOnce"),this._registerListener(i,!0,t,n)},remove:function(i){e(i,"remove");var t=this._indexOfListener(i);return-1!==t&&(this._bindings[t]._destroy(),this._bindings.splice(t,1)),i},removeAll:function(){for(var i=this._bindings.length;i--;)this._bindings[i]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(i){if(this.active){var t=Array.prototype.slice.call(arguments),n=this._bindings.slice(),e=this._bindings.length;this._shouldPropagate=!0;do{e--}while(n[e]&&this._shouldPropagate&&!1!==n[e].execute(t))}},dispose:function(){this.removeAll(),delete this._bindings},toString:function(){return"[Signal active: "+this.active+" numListeners: "+this.getNumListeners()+"]"}},i.signals=t}(window||this);
